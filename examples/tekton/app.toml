namespace = "default"
appbase = "helloworld-maven-0.5.2.tgz" 
pipeline = "tekton"
cluster = "c1"
helmrepo = "chartmuseum"

[tekton]
installSteps = ["get-dockerfile", "mvn-package", "build-and-push", "helm-install", "rsync"]
updateSteps = ["get-dockerfile", "mvn-package", "build-and-push", "helm-upgrade", "rsync"]

[chart]
name = "tomcat-fccstest-maven"
version = "0.1.0"
appVersion = "1.0"
apiVersion = "v1"
description = "A Helm chart for Kubernetes, Auto generated by jxl"

[git]
repo = "http://git.fccs.com/fccs/fccs2.git"
branch = "develop_docker"

[docker]
base = "jxregistry.docker.fccs.cn:28888/tomcat/tomcat6-jdk6:prom-1.1"
port = "8080"
package = "target/fccs2"
workdir = "/usr/local/tomcat/webapps/ROOT"

[helm]
replicaCount = 2
projectid = 81
imagePullSecrets = "myregistrykey"
command =  ["/bin/bash"]
args = ["-c", "/usr/local/tomcat/bin/catalina.sh run >> /usr/local/tomcat/logs/${MY_POD_NAME}.${MY_POD_NAMESPACE}.catalina.out 2>&1"]
dnsPolicy = "None"

  [helm.image]
  repository = "jxregistry.docker.fccs.cn:28888"
  name = "tomcat/maven/tomcat-fccstest-maven"
  tag = "latest"
  pullPolicy = "IfNotPresent"

  [helm.service]
  type = "LoadBalancer"
  port = 8080
  targetport = 8080
  loadBalancerIP = ""
  healthCheck = "/heartbeat.jsp"

  [helm.resources]
    [helm.resources.requests]
    memory = "512Mi"
    cpu = "200m"
    [helm.resources.limits]
    memory = "4096Mi"
    cpu = "1000m"

  [[helm.volumes]]
    name = "tomcat-log"
    [helm.volumes.hostPath]
    path = "/var/log/dockerapp/81/"

  [[helm.volumeMounts]]
    name = "tomcat-log"
    mountPath = "/usr/local/tomcat/logs"

  [helm.env]
    [helm.env.podInfo]
    name = "podInfo"
      [helm.env.podInfo.data]
      MY_POD_NAME = "metadata.name"
      MY_POD_NAMESPACE = "metadata.namespace"
      MY_POD_IP = "status.podIP"

    [helm.env.otherInfo]
    name = "otherInfo"
      [helm.env.otherInfo.data]
      LANG = "zh_CN.UTF-8"
      XMS = "256m"
      XMX = "2048m"

  [helm.securityContext]
  runAsUser = 1501
  fsGroup = 1501

  [helm.dnsConfig]
  nameservers = ["192.168.1.85"]
